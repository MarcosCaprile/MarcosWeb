<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Universe Simulator · Marcos Caprile-Santos</title>
  <link rel="stylesheet" href="../styles.css" />

  <style>
    /* Sicherheitsnetz: Der Container hat garantiert eine Höhe */
    #sceneWrap{
      height: 520px;
      border-radius: 22px;
      overflow: hidden;
      background: #000;      /* falls transparent -> trotzdem sichtbar */
      border: 1px solid rgba(14,20,18,.12);
      box-shadow: 0 18px 50px rgba(14,20,18,.08);
    }
    canvas{ display:block; width:100%; height:100%; }
    .hint{ margin-top: 12px; color: rgba(14,20,18,.6); font-size: 14px; }
  </style>
</head>

<body>
  <!-- Topbar (wenn du sie global nutzt, kannst du hier auch deine nav einkopieren) -->
  <nav class="topbar visible">
    <div class="wrap nav-inner">
      <a class="logo" href="../index.html#hero" aria-label="Home">MCS</a>
      <div class="nav-links">
        <a href="../index.html#projects">← Zurück</a>
      </div>
    </div>
  </nav>

  <main class="wrap" style="padding-top:90px;">
    <section class="card">
      <h2>Universe Simulator</h2>
      <p class="muted">Interaktives 3D-Showcase (Rotation: Drag · Zoom: Wheel)</p>

      <div id="sceneWrap"></div>
      <div class="hint">Wenn du hier eine goldene Kugel siehst, läuft Three.js korrekt.</div>
    </section>
  </main>

  <!-- Three.js (ohne Module) -->
  <script src="https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/three@0.160.0/examples/js/controls/OrbitControls.js"></script>

  <script>
    // Debug: sofort sehen ob Script läuft
    console.log("Universe script loaded ✅");
    console.log("THREE:", window.THREE ? THREE.REVISION : "NOT LOADED");

    const wrap = document.getElementById("sceneWrap");
    if (!wrap) throw new Error("sceneWrap not found");

    const scene = new THREE.Scene();

    const camera = new THREE.PerspectiveCamera(55, 1, 0.1, 2000);
    camera.position.set(0, 12, 26);

    const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: false });
    renderer.setPixelRatio(Math.min(window.devicePixelRatio || 1, 2));
    renderer.setClearColor(0x000000, 1);
    wrap.appendChild(renderer.domElement);

    function resize(){
      const w = wrap.clientWidth || 800;
      const h = wrap.clientHeight || 520;
      renderer.setSize(w, h, false);
      camera.aspect = w / h;
      camera.updateProjectionMatrix();
    }
    resize();
    window.addEventListener("resize", resize);

    const controls = new THREE.OrbitControls(camera, renderer.domElement);
    controls.enableDamping = true;

    // Licht
    scene.add(new THREE.AmbientLight(0xffffff, 0.35));
    const dir = new THREE.DirectionalLight(0xffffff, 1.2);
    dir.position.set(10, 20, 10);
    scene.add(dir);

    // Test-Kugel (damit du garantiert etwas siehst)
    const sphere = new THREE.Mesh(
      new THREE.SphereGeometry(1.6, 48, 48),
      new THREE.MeshStandardMaterial({
        color: 0xb89b5e,
        metalness: 0.9,
        roughness: 0.25
      })
    );
    scene.add(sphere);

    // Sterne (einfacher Hintergrund)
    const starsGeo = new THREE.BufferGeometry();
    const starCount = 1200;
    const pos = new Float32Array(starCount * 3);
    for(let i=0;i<starCount;i++){
      const r = 120 * Math.random() + 40;
      const a = Math.random() * Math.PI * 2;
      const b = (Math.random() - 0.5) * Math.PI;
      pos[i*3+0] = r * Math.cos(a) * Math.cos(b);
      pos[i*3+1] = r * Math.sin(b);
      pos[i*3+2] = r * Math.sin(a) * Math.cos(b);
    }
    starsGeo.setAttribute("position", new THREE.BufferAttribute(pos, 3));
    const stars = new THREE.Points(
      starsGeo,
      new THREE.PointsMaterial({ color: 0xffffff, size: 0.6, transparent: true, opacity: 0.65 })
    );
    scene.add(stars);

    function loop(){
      requestAnimationFrame(loop);
      sphere.rotation.y += 0.004;
      controls.update();
      renderer.render(scene, camera);
    }
    loop();
  </script>
</body>
</html>
